# 04. networking





## 1. VPC

- Virtual Private Cloud
- AWS에서의 사용자 고유 프라이빗 네트워크
- AWS 리소스용 프라이빗 IP 범위를 정의하고 VPC에 EC2 인스턴스나 ELB 같은 요소를 배치할 수 있음.
- 게이트웨이 (like 커피숍 출입구)가 없다면 누구도 VPC 안에 있는 리소스에 접근 X
- 비공개 내부 AWS 리소스로 가는 암호화된 VPN 연결을 만들고 싶다면 가상 프라이빗 게이트웨이를 VPC에 연결
- 최대한 짧은 지연 시간과 최대한 높은 수준의 보안
- -> AWS Direct Connect 라는 기능을 이용하여 이를 달성할 수 있음.

**요약**

1. 수백만명의 고객의 리소스에 경계가 없으면 네트워크 트래픽이 제한 없이 리소스 간에 흐를 수 있음.
2. 고로, AWS 리소스에 경계를 설정하는 데 사용할 수 있는 네트워킹 서비스 = VPC
3. AWS 클라우드의 격리된 섹션을 프로비저닝할 수 있음.

 

#### **VPC에서 서브넷을 사용하는 유일한 기술적인 이유는?**

- 게이트웨이에 대한 액세스 관리를 위함.**

 

### **가상 프라이빗 게이트웨이(VPN)**

- VPC 내의 비공개 리소스에 액세스하기 위한 게이트웨이
- 보호된 인터넷 트래픽이 VPC로 들어오도록 허용하는 구성 요소.
- VPC와 프라이빗 네트워크(회사 네트워크같은) 간에 가상 프라이빗 네트워크(VPN) 연결을 설정할 수 있음.



## 2. Subnet

- 리소스 (예를 들어 EC2 인스턴스)를 포함할 수 있는 VPC 섹션
- 퍼블릭 또는 프라이빗 일 수 있음.
- 퍼블릭서브넷 -> 누구나 액세스 할 수 있어야 하는 리소스가 포함 
  ex) 온라인 상점의 웹사이트
- 프라이빗 서브넷 -> 개인정보 등이 포함된 데이터베이스 같은 리소스가 포함.
- VPC 내에서 서브넷은 서로 통신할 수 있음.

 

### **VPC의 네트워크 트래픽**

- 고객이 AWS 클라우드에서 호스팅되는 애플리케이션에 데이터를 요청하면 이 요청은 패킷으로 전송이 됨.
- 패킷은 인터넷 게이트웨이를 통해 VPC로 들어감.
- 서브넷으로 들어가거나 나오려면 먼저 권한을 확인해야 함.
- 이러한 사용 권한은 패킷을 보낸 사람과 패킷이 서브넷의 리소스와 통신하려는 방법을 나타냄.
- 서브넷의 패킷 권한을 확인하는 VPC 구성 요소는 네트워크 ACL(액세스 제어 목록)



### **네트워크 ACL (액세스 제어 목록)**

- 서브넷 수준에서 인바운드 및 아웃바운드 트래픽을 제어하는 "가상 방화벽"
- 공항의 "출입국 심사 직원" 과 같은 맥락
- 각 AWS 계정에는 기본 네트워크 ACL이 포함됨
- VPC를 구성할 때 계정의 기본 네트워크 ACL을 사용하거나 생성할 수 있음.
- 기본 네트워크 액세스 제어 목록은 상태 비저장이며 모든 인바운드 및 아웃바운드 트래픽을 허용함
- 사용자가 자체 규칙을 추가하거나 수정할 수 있음.

##### **상태 비저장 패킷 필터링**

- 아무것도 기억하지 않고 각 방향(인바운드 및 아웃바운드)으로 서브넷 경계를 통과하는 패킷만 확인
- 해당 요청에 대한 패킷 응답이 서브넷으로 반환될 때 네트워크 ACL은 이전 요청을 기억하지 못함.
- 패킷이 서브넷에 들어간 후에는 서브넷 내의 리소스(예를 들어 EC2 인스턴스)에 대한 권한이 평가되어야함.
- 패킷에서 Amazon EC2 인스턴스에 대한 권한을 확인하는 VPC 구성요소는 "보안 그룹"

  

### **보안 그룹**

- Amazon EC2 인스턴스에 대한 인바운드 및 아웃바운드 트래픽을 제어하는 "가상 방화벽"
- 상태 저장이며, 기본적으로 모든 인바운드 트래픽을 거부하고 아웃바운드 트래픽을 허용.
- -> 상태 저장은 즉, 인스턴스에 대한 새 요청을 평가할 때 이전 트래픽 패턴 및 흐름을 사용.
- 예를 들어 로비에서 방문객을 안내하는 경비원이 있는 호텔을 생각해본다면, 방문객=패킷, 경비원=보안그룹

  **상태 저장 패킷 필터링**

- 보안 그룹은 상태 저장 패킷 필터링을 수행함.
- 즉, 들어오는 패킷에 대한 이전 결정을 기억함



## 3. Direct connect

- 데이터 센터와 VPC 간에 비공개 전용 연결을 설정하는 서비스
  - 아파트 입주자만 이용할 수 있는 복도, 통로
- 네트워크 비용을 절감하고 대역폭을 늘리는 데 도움이 됨.

 



## 4. Domain Name System(DNS)

- Domain Name System
- 쉽게 이야기해서 번역 서비스 또는 인터넷의 전화번호부
- 언어를 번역하는 대신 웹사이트 이름을 컴퓨터가 읽을 수 있는 주소인 IP, 즉 인터넷 프로토콜로 번역

 

### **Amazon Route 53**

- DNS 웹 서비스
- 개발자와 비즈니스가 최종 사용자를 AWS에서 호스팅되는 인터넷 애플리케이션으로 라우팅할 수 있는 안정적인 방법 제공
- 사용자 요청을 AWS에서 실행되는 인프라 (예를 들어 EC2 인스턴스, 로드밸런서)에 연결
- 또한 사용자를 AWS 외부의 인프라로 라우팅할 수 있음.
- DNS 레코드를 관리하는 기능도 가지고 있다. -> 직접 새 도메인 이름을 등록할 수도 있음.





















