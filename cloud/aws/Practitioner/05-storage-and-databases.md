# 05. storage and database



- Amazon Elastic Block Store(Amazon EBS)
- Amazon Simple Storage Solution(Amazon S3)
- Amazon Elastic File System(Amazon EFS)
- 다양한 스토리지 솔루션
- Amazon Relational Database Service(RDS)
- Amazon DynamoDB
- 다양한 데이터베이스 서비스





## 1. 인스턴스 스토어 및 Amazon Elastic Block Store (Amazon EBS)

- Amazon EC2를 사용하여 비즈니스 애플리케이션을 실행한다면 이러한 애플리케이션은 CPU, 메모리, 네트워크 및 스토리지에 액세스 해야함. EC2 인스턴스를 이용하면 이렇게 다양한 구성 요소에 액세스 할 수 있음. 
- 애플리케이션이 실행되면 대부분의 경우 블록 수준 스토리지에 액세스를 해야함.

### **인스턴스 스토어**

- 블록 수준 스토리지 볼륨은 물리적 하드 드라이브처럼 동작함.
- 인스턴스 스토어는 EC2 인스턴스에 임시 블록 수준 스토리지를 제공
- 물리적으로 EC2 인스턴스의 호스트 컴퓨터에 연결되어 있고, 따라서 인스턴스와 수명이 동일한 디스크 스토리지
- 인스턴스가 종료되면 인스턴스 스토어의 데이터가 손실됨. 

#### 볼륨(Volume)이란?

- 파일 시스템으로 포맷된 디스크상의 저장영역
- 하나의 파일 시스템을 갖춘 하나의 접근 가능한 스토리지 영역
- 볼륨에는 드라이브 문자가 할당됨.



## 2. Amazon EBS

- Amazon Elastic Block Store
- "단일 가용 영역에 데이터 저장"
- EC2 인스턴스에서 사용할 수 있는 블록 수준 스토리지 볼륨을 제공하는 서비스
- EC2 인스턴스를 중지 또는 종료하더라도 연결된 EBS 볼륨의 모든 데이터를 사용할 수 있음.
- EBS 볼륨을 생성하려면 구성(크기&유형)을 정의하고 볼륨을 프로비저닝함.
  - 이후 EBS 볼륨을 생성하고 EC2 인스턴스에 연결
- 보존해야 하는 데이터를 위한 것이므로 "데이터 백업"이 중요함. 스냅샷을 생성하여 증분.
- 블록스토리지에서 파일을 수정하면 변경된 부분만 업데이트 됨.

#### **증분 백업이란?**

- 처음 볼륨을 백업하면 "모든" 데이터가 복사
- 이후의 백업에서는 가장 최근의 스냅샷 이후 변경된 데이터 블록만 저장
- "전체 백업"과는 다른 개념!!!! 전체 백업은 변경되지 않은 데이터도 포함됨.

 

## 3. S3

### **Amazon Simple Storage Service(Amazon S3)**

- 규모에 상관없이 무한대의 데이터를 저장하고 검색할 수 있는 데이터 저장소

 

### 객체와 버킷

- 하드 드라이브에 있는 파일은 "객체"
- 파일 디렉터리는 "버킷"
- S3에서 업로드 할 수 있는 최대 크기는 5TB

 

### **객체 스토리지**

- 객체 스토리지에서 각 객체는 "데이터" "메타데이터" "키" 로 구성됨.
- 데이터 : 이미지, 동영상, 텍스트 문서 또는 기타 유형 파일들
- 메타데이터 : 데이터의 내용, 사용 방법, 객체 크기 등
- 키 : 고유한 식별자
- 모든 파일을 완성된 개별 객체러 취급함.
- 블록스토리지에서 파일을 수정하면 변경된 부분만 업데이트 됨.



### Amazon S3 스토리지 클래스

- Amazon Simple Storage Service 
- 무한대의 데이터 저장 및 검색이 가능한 데이터 저장소
- 객체 수준 스토리지를 제공하는 서비스, 데이터를 버킷에 객체로 저장함.
- 데이터를 객체로 저장 -> 객체를 버킷에 저장 -> 최대 5TB크기의 객체를 업로드 -> 객체 버전 관리 -> 여러 버킷 생성
- 이미지, 동영상, 텍스트 파일 등 모든 유형 파일 업로드 가능.
- 저장 공간 무한. / 객체의 최대 크기 5TB.
- 파일을 업로드할 때 권한 설정을 통해 표시 여부 및 액세스 제어 가능.
- 버전 관리 기능을 사용하여 시간 경과에 따른 객체 변경 사항 추적 가능.

 

### Amazon S3 스토리지 클래스 6가지

- 사용한 만큼만 비용 지불, 요구 사항에 맞춰 다양한 스토리지 클래스 중 선택 가능.
- "데이터를 검색할 빈도", "필요한 데이터 가용성"

 

### **S3 Standard**

- 자주 액세스 하는 데이터용으로 설계 / 최소 3개의 가용 영역에 데이터 저장
- 고가용성 -> 광범휘한 사용 사례에 적합 ex) 데이터분석, 콘텐츠 배포
- 자주 액세스하지 않는 데이터 및 보관 스토리지를 위한 다른 스토리지 클래스보다 비용이 높다!

### **S3 Standard-Infrequent Access**

- S3 Standard-IA
- 자주 액세스하지 않는 데이터에 이상적 / 필요한 경우 즉시 사용할 수 있어야함!
- Standard와 비슷하지만 가격은 더 저렴하고 / 검색 가격은 더 높음.

### **S3 One Zone-Infrequent Access**

- S3 One Zone-IA
- 단일 가용 영역에 데이터 저장
- S3 Standard-IA 보다 낮은 스토리지 가격

### **S3 Intelligent-Tiering**

- 액세스 페턴을 알 수 없거나 자주 변화하는 데이터에 이상적
- 객체당 소량의 월별 모니터링 및 자동화 요금을 부과함. 

### **S3 Glacier**

- 데이터 보관용으로 설계된 이상적인 저비용 스토리지
- 객체를 몇 분에서 몇 시간 이내에 검색

### **S3 Glacier Deep Archive**

- 보관에 이상적인 가장 저렴한 객체 스토리지 클래스
- 객체를 12시간 이내에 검색

 

### EBS vs S3

### EBS

- 최대 16테라, EC2 종료 후 생존, SSD, HDD옵션,  블락단위
- 큰 파일의 잦은 수정,추가가 잇으면 유리
  - 저장할 때, 블락단위로 가능.

### S3

- 웹 지원, 리전 별 분산, 비용절감효과, 서버리스
- 무제한 스토리지, 최대 5TB 개별객체, 한번쓰기 여러번읽기 (WORM), 내구성 99.99999 (백업전략 필요없음)
- 전체 객체를 읽고, 수정,추가가 거의 없으면 유리.
  - 저장할 때, 무조건 5테라 단위로 저장해야 함.





## 4. Amazon Elastic File System(Amazon EFS)

- Amazon EFS
- 리전별 서비스, "여러" 가용 영역에 걸쳐 데이터를 저장 
- AWS 클라우드 서비스 및 온프레미스 리소스와 함께 사용되는 확장 가능한 파일 시스템
- 파일을 추가 또는 제거하면 EFS가 자동으로 확장하거나 축소됨.
- 애플리케이션을 중단하지 않고 온디맨드로 페타바이트 규모로 확장할 수 있음. 

### 파일 스토리지

- 여러 클라이언트가 공유 파일 폴더에 저장된 데이터에 액세스 할 수 있음.
- 스토리지 서버가 블록스토리지를 로컬 파일 시스템과 함께 사용
- 많은 수의 서비스 및 리소스가 동시에 동일한 데이터에 액세스해야 하는 사용 사례에 이상적임.

 

### EBS vs EFS

**Amazon EBS**

- Amazon EBS 볼륨은 **단일** 가용 영역에 데이터를 저장합니다. 
- Amazon EC2 인스턴스를 EBS 볼륨에 연결하려면 Amazon EC2 인스턴스와 EBS 볼륨 모두 동일한 가용 영역에 상주해야 합니다.
- 볼륨이 자동 확장되지 않는다.



Amazon EFS는 리전별 서비스입니다. 이 서비스는 **여러** 가용 영역에 걸쳐 데이터를 저장합니다. 

- 중복 스토리지를 사용하면 파일 시스템이 위치한 리전의 모든 가용 영역에서 동시에 데이터에 액세스할 수 있습니다. 또한 온프레미스 서버는 AWS Direct Connect를 사용하여 Amazon EFS에 액세스할 수 있습니다.
- 볼륨이 자동 확장된다.
- EC2 데이터를 모두 입력 가능함.



## 5. Amazon Relational Database Service(Amazon RDS)

- Amazon RDS
- AWS 클라우드에서 관계형 데이터베이스를 실행할 수 있는 서비스
- 하드웨어 프로비저닝, 데이터베이스 설정, 패치 적용 백업과 같은 작업을 자동화
- AWS Lambda를 사용하여 서버리스 애플리케이션에서 데이터베이스를 쿼리 하는 등 활용 가능.
- 다양한 보안 옵션 제공 (저장 시 암호화 / 전송 중 암호화)

### 종류

- Amazon Aurora
- PostgreSQL
- MySQL
- MariaDB
- Oracle Database
- Microsoft SQL Server

### **Amazon Aurora**

- 엔터프라이즈급 관계형 데이터베이스
- MySQL 및 PostgreSQL 관계형 데이터베이스와 호환됨.
- 표준 MySQL 데이터베이스보다 최대 5배 / PostgreSQL보다 최대 3배 빠름!
- 불필요한 입/출력(I/O) 작업을 줄여 데이터베이스 비용 절감.
- 워크로드에 고가용성이 필요한 경우 고려해볼만한 데이터베이스
- 6개의 데이터 복사본을 3개의 가용 영역에 복제하고 지속적으로 S3에 데이터를 백업함.



## 6. Amazon DynamoDB

- 서버리스 키-값 데이터베이스 서비스
- 모든 규모에서 한 자릿수 밀리초의 성능 제공
- 서버를 사용하지 않음! -> 프로비저닝, 패치 적용 또는 관리가 필요 없음.
- 데이터베이스 크기 자동 조정
- 따라서, 크기를 조정하는 동안에도 고성능이 필요한 사용 사례에 적합

 

### 서버리스

- DynamoDB는 서버를 사용하지 않으므로 서버를 프로비저닝, 패치 적용 또는 관리할 필요가 없습니다. 
- 또한 소프트웨어를 설치, 유지 관리, 운영할 필요도 없습니다.

### 자동조정

- 데이터베이스 크기가 축소 또는 확장되면 DynamoDB는 용량 변화에 맞춰 자동으로 크기를 조정하면서도 일관된 성능을 유지합니다. 
- 따라서 크기를 조정하는 동안에도 고성능이 필요한 사용 사례에 적합한 선택입니다.





##  7. Amazon Redshift

- 빅데이터 분석에 사용할 수 있는 데이터 웨어하우징 서비스
- 여러 원본에서 데이터를 수집하여 데이터 간의 관계 및 추세를 파악하는 데 도움이 되는 기능 제공.
- 확장성이 대단히 뛰어남



## 8. AWS Database Migration Service

- 관계형 데이터베이스, 비관계형 데이터베이스 및 기타 유형의 데이터 저장소를 마이그레이션 할 수 있는 서비스



### 개발 및 테스트 데이터베이스 마이그레이션

- 프로덕션 사용자에게 영향을 주지 않고 개발자가 프로덕션 데이터에서 애플리케이션을 테스트할 수 있도록 지원

### 데이터베이스 통합

- 여러 데이터베이스를 단일 데이터베이스로 결합

### 연속 복제

- 일회성 마이그레이션을 수행하는 것이 아니라 데이터의 진행 중 복제본을 다른 대상 원본으로 전송





## 9. 추가 데이터베이스 서비스

### Amazon DocumentDB

- 콘텐츠 관리, 카탈로그, 사용자 프로필 등에 적합
- 사소한 속성까지 커버 가능한 완전 콘텐츠 관리 시스템
- MongoDB 워크로드를 지원하는 문서 데이터베이스 서비스 

#### **Amazon Neptune**

- 그래픽 데이터베이스 서비스

#### **Amazon Quantum Ledger Database**

- Amazon QLDB
- 원장 데이터베이스 서비스
- 모든 변경 사항 전체 기록 검토 가능

#### **Amazon Managed Blockchain**

- 오픈소스 프레임워크를 사용하여 블록체인 네트워크를 생성하고 관리

### **Amazon ElastiCashe**

- 자주 사용되는 요청의 읽기 시간을 향상시키기 위해 데이터베이스 위에 캐싱 계층을 추가하는 서비스
- Redis 및 Memcached를 지원함.

#### **Amazon DynamoDB Accelerator**

- DynamoDB용 인 메모리 캐시
- 응답 시간을 한 자릿수 밀리초에서 마이크로초까지 향상시킬 수 있음.



